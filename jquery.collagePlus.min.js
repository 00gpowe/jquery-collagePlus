/*!
 *
 * jQuery collagePlus Plugin v0.1.0
 * https://github.com/ed-lea/jquery-collagePlus
 *
 * Copyright 2012, Ed Lea twitter.com/ed_lea
 *
 * built for http://qiip.me
 *
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 *
 */
(function(a){a.fn.collagePlus=function(b){function d(b,c,d){var e=c-d.albumWidth+d.padding*(b.length-1);var f=Math.floor(e/b.length);var g=0;for(var h=0;h<b.length;h++){$obj=a(b[h][0]);var i=b[h][1]-f;var j=typeof fn=="undefined"?Math.round(b[h][2]*(d.albumWidth/c)):j;if(h==b.length-1&&g+i>d.albumWidth&&b.length){i=i-(g+i-d.albumWidth)}g+=i+d.padding;$obj.width(i);if($obj.not("img")){$obj.find("img").width(i)}$obj.height(j);if($obj.not("img")){$obj.find("img").height(j)}var k={"margin-bottom":d.padding+"px","margin-right":h<b.length-1?d.padding+"px":"0px",display:d.display,"vertical-align":"bottom",overflow:"hidden"};$obj.css(k);$obj.animate({opacity:"1"},{duration:d.fadeSpeed})}}var c=a.extend({targetHeight:400,albumWidth:this.width(),padding:5,images:a(this).children(),fadeSpeed:"fast",display:"inline-block"},b);return this.each(function(){var b=0,e=[];c.images.each(function(f){var g=a(this),h=g.is("img")?g:a(this).find("img");var i=typeof h.data("width")!="undefined"?h.data("width"):h.width(),j=typeof h.data("height")!="undefined"?h.data("height"):h.height();h.data("width",i);h.data("height",j);var k=Math.ceil(i/j*c.targetHeight),l=Math.ceil(c.targetHeight);if(k>c.albumWidth){d(e,b,c);delete b;delete e;b=0;e=[]}e.push([this,k,l]);b+=f<e.length-1?k+c.padding:k;if(b>c.albumWidth){d(e,b,c);delete b;delete e;b=0;e=[]}if(c.images.length-1==f&&e.length!=0){d(e,b,c);delete b;delete e;b=0;e=[]}})})}})(jQuery)